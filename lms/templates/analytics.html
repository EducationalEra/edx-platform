<%! from django.utils.translation import ugettext as _ %>
<%! from student.models import UserProfile %>
<%! from django.core.urlresolvers import reverse %>

<%inherit file="main.html" />
<%namespace name='static' file='static_content.html'/>

<%block name="pagetitle">${_("Analytics")}</%block>
<%block name="bodyclass">view-dashboard is-authenticated</%block>
<%block name="nav_skip">#my-courses</%block>

<%block name="js_extra">
  <script type="text/javascript">
    $(document).ready(function(){
      var course= $('select#course');
      var question = $('select#question');
      course.change(function(ev){
        question.empty();
        $.ajax({
          url: '${reverse('analytics')}',
          type: "GET",
          data: {course: $(ev.target).val()},
          success: function(response){
            var questions = response.questions;
            var optionalHtml = '';
            for (i = 0, len = questions.length; i < len; i++) {
              optionalHtml += '<option value="' + questions[i][0] + '">' + questions[i][1] + '</option>';
            }
            question.html(optionalHtml);
          }
        })
      })
    });
  </script>
</%block>

<section class="register container" style="padding: 1px 30px;">
  <div class="theme-container">
    <section class="contact-container">
    <h1>${_("Analytics")}</h1>

    <p></p>


    <div class="group group-form group-form-requiredinformation">
      <form method="get" action="" id="webform-client-form-285" accept-charset="UTF-8">
        <ol class="list-input">

          <li class="field-group field-gender">
            <div class="field select" id="field-gender">
              <label for="gender">${_("Gender")}</label>
              <select id="gender" name="gender">
                <option value="">--</option>
                %for code, gender in UserProfile.GENDER_CHOICES:
                <option ${'selected' if selected_gender == code else '' } value="${code}">${_(gender)}</option>
                %endfor
              </select>
            </div>
          </li>

          <li class="field-group field-yob">
            <div class="field select" id="field-yob">
              <label for="yob">${_("Age Range")}</label>
              <select id="yob" name="age_range">
                <option value="">--</option>
                %for code, age_range in UserProfile.AGE_RANGE_CHOICES:
                <option ${'selected' if selected_age_range == code else ''} value="${code}">${_(age_range)}</option>
                %endfor
              </select>
            </div>
          </li>

          <li class="field-group field-education-level">
            <div class="field select" id="field-education-level">
              <label for="education-level">${_("Education")}</label>
              <select id="education-level" name="level_of_education">
                <option value="">--</option>
                %for code, ed_level in UserProfile.LEVEL_OF_EDUCATION_CHOICES:
                <option ${'selected' if selected_level_of_education == code else ''} value="${code}">${_(ed_level)}</option>
                %endfor
              </select>
            </div>
          </li>

          <li class="field-group field-course">
            <div class="field select" id="field-course">
              <label for="course">${_("Course")}</label>
              <select id="course" name="course">
                %for course in courses:
                <option ${'selected' if selected_course == course.location.course_key else ''} value="${course.location.course_key}">${course.display_name}</option>
                %endfor
              </select>
            </div>
          </li>

          <li class="field-group field-question">
            <div class="field select" id="field-question">
              <label for="question">${_("Question")}</label>
              <select id="question" name="question">
                %for question in questions:
                <option ${'selected' if selected_question == question.location else ''} value="${question.location}">${question.display_name}</option>
                %endfor
              </select>
            </div>
          </li>

        </ol>
        <input type="submit" value="${_("Submit")}" class="analytics-action" />
      </form>
      %if percentage_correct_answers is not None:
        <p>${_("Enrollment")}: ${enrollment}</p>
        <hr/>
        <p>${_("Male")}: ${percentage_male}%</p>
        <p>${_("Female")}: ${percentage_female}%</p>
        <p>${_("Other")}: ${percentage_other}%</p>
        <hr />
        <p>${_("Below 25")}: ${percentage_25}%</p>
        <p>${_("25-34")}: ${percentage_25_34}%</p>
        <p>${_("35-44")}: ${percentage_35_44}%</p>
        <p>${_("45-54")}: ${percentage_45_54}%</p>
        <p>${_("Above 55")}: ${percentage_55}%</p>
        <hr />
        <p>${_("Doctorate")}: ${percentage_p}%</p>
        <p>${_("Master's or professional degree")}: ${percentage_m}%</p>
        <p>${_("Bachelor's degree")}: ${percentage_b}%</p>
        <p>${_("Associate's degree")}: ${percentage_a}%</p>
        <p>${_("Secondary/high school")}: ${percentage_hs}%</p>
        <p>${_("Junior secondary/junior high/middle school")}: ${percentage_jhs}%</p>
        <p>${_("Elementary/primary school")}: ${percentage_el}%</p>
        <p>${_("None")}: ${percentage_none}%</p>
        <p>${_("Other")}: ${percentage_o}%</p>
        <hr />
        <p>${_("Correct answers")}: ${percentage_correct_answers}%</p>
      %endif

    </div>
  </section>
  </div>
</section>
